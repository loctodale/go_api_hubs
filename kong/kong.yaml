_format_version: "3.0"
services:
  - name: account-service
    host: account-service
    port: 6000
    protocol: grpc
    routes:
      - name: account-route
        strip_path: false
        paths:
          - /account
        plugins:
          - name: grpc-gateway
            config:
              proto: /account/proto/account.proto
      - name: private-account-route
        strip_path: false
        paths:
          - /private/account
        plugins:
          - name: grpc-gateway
            config:
              proto: /account/proto/account.proto
          - name: jwt
            config:
              key_claim_name: sub
              header_names:
                - authorization
          - name: acl
            config:
              allow:
                - member
  - name: apis-service
    host: apis-service
    port: 6002
    protocol: grpc
    routes:
      - name: apis-route
        strip_path: false
        paths:
          - /apis/private
          - /plan/private
          - /api_keys/private
        plugins:
          - name: grpc-gateway
            config:
              proto: /apis/proto/apis.proto
          - name: jwt
            config:
              key_claim_name: sub
              header_names:
                - authorization
          - name: acl
            config:
              allow:
                - member
